class PopupContactUs{constructor(e){this.popupElement=e}open(){if(!this.popupElement.querySelector(".feedback_form")){const e=()=>{$.ajax({dataType:"html",url:"contact_us",type:"GET",beforeSend:function(){},success:e=>{this.popupElement.insertAdjacentHTML("beforeend",e),this.submitForm(t)},error:()=>{this.popupElement.querySelector(".feedback_form")||(this.popupElement.insertAdjacentHTML("beforeend",'<form class="feedback_form"></form>'),this.popupElement.querySelector("form").insertAdjacentHTML("beforeend",'<p class="popup-write-us__error-message">Произошла ошибка попробуйте повторить позже</p>'))}}).done(function(e){})},t=e=>{const t=e?"addEventListener":"removeEventListener";this.popupElement[t]("click",o),this.popupElement[t]("click",p),document[t]("keydown",r)};this.popupElement.style.display="flex",e(this.popupElement);const o=e=>{const o=e.target,p=this.popupElement.querySelector(".close-modal"),r=this.popupElement.querySelector(".close-modal img");o!==p&&o!==r||(this.close(),t(!1))},p=e=>{e.target===this.popupElement&&(e.preventDefault(),this.close(),t(!1))},r=e=>{"Escape"===e.key&&(e.preventDefault(),this.close(),t(!1))};t(!0)}}close(){this.popupElement.querySelector(".feedback_form")&&(this.popupElement.style.display="none",this.popupElement.querySelector(".feedback_form").remove())}submitForm(e){this.popupElement.querySelector("form")&&this.popupElement.querySelector("form").addEventListener("submit",t=>{t.preventDefault(),$.ajax({url:"contact_us",type:"POST",beforeSend:function(){},data:$(this.popupElement.querySelector("form")).serialize(),success:()=>{this.close(),e(!1)},error:()=>{this.popupElement.querySelector(".popup-write-us__error-message")||(this.popupElement.querySelector(".popup__wrap").remove(),this.popupElement.querySelector("form").insertAdjacentHTML("beforeend",'<p class="popup-write-us__error-message">Произошла ошибка попробуйте повторить позже</p>'))}}).done(function(e){})})}}