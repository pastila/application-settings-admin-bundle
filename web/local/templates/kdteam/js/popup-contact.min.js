class PopupContactUs{constructor(e){this.popupElement=e}open(){if(!this.popupElement.querySelector(".feedback_form")){const e=()=>{$.ajax({dataType:"html",url:"contact_us",type:"GET",beforeSend:function(){},success:e=>{this.popupElement.insertAdjacentHTML("beforeend",e),this.submitForm()},error:()=>{this.popupElement.querySelector(".feedback_form")||(this.popupElement.insertAdjacentHTML("beforeend",'<form class="feedback_form"></form>'),this.popupElement.querySelector("form").insertAdjacentHTML("beforeend",'<p class="popup-write-us__error-message">Произошла ошибка попробуйте повторить позже</p>'))}}).done(function(e){})};this.popupElement.style.display="flex",e(this.popupElement);const t=e=>{const p=e.target,o=this.popupElement.querySelector(".close-modal"),r=this.popupElement.querySelector(".close-modal img");p!==o&&p!==r||(this.close(),this.popupElement.removeEventListener("click",t))},p=e=>{e.target===this.popupElement&&(e.preventDefault(),this.close(),this.popupElement.removeEventListener("click",p))},o=e=>{"Escape"===e.key&&(e.preventDefault(),this.close())};document.addEventListener("keydown",o),this.popupElement.addEventListener("click",p),this.popupElement.addEventListener("click",t)}}close(){this.popupElement.querySelector(".feedback_form")&&(this.popupElement.style.display="none",this.popupElement.querySelector(".feedback_form").remove())}submitForm(){this.popupElement.querySelector("form")&&this.popupElement.querySelector("form").addEventListener("submit",e=>{e.preventDefault(),$.ajax({url:"contact_us",type:"POST",beforeSend:function(){},data:$(this.popupElement.querySelector("form")).serialize(),success:()=>{this.close()},error:()=>{this.popupElement.querySelector(".popup-write-us__error-message")||(this.popupElement.querySelector(".popup__wrap").remove(),this.popupElement.querySelector("form").insertAdjacentHTML("beforeend",'<p class="popup-write-us__error-message">Произошла ошибка попробуйте повторить позже</p>'))}}).done(function(e){})})}}