var x,i,j,selElmnt,a,b,c;for(x=document.getElementsByClassName("custom-select"),i=0;i<x.length;i++){for(selElmnt=x[i].getElementsByTagName("select")[0],(a=document.createElement("DIV")).setAttribute("class","select-selected"),a.innerHTML=selElmnt.options[selElmnt.selectedIndex].innerHTML,x[i].appendChild(a),(b=document.createElement("DIV")).setAttribute("class","select-items select-hide"),j=1;j<selElmnt.length;j++)(c=document.createElement("DIV")).innerHTML=selElmnt.options[j].innerHTML,c.setAttribute("data-id-cite",selElmnt.options[j].value),c.setAttribute("class","select-city"),c.addEventListener("click",function(e){var t,a,n,s,l;for(s=this.parentNode.parentNode.getElementsByTagName("select")[0],l=this.parentNode.previousSibling,a=0;a<s.length;a++)if(s.options[a].innerHTML==this.innerHTML){if(s.selectedIndex=a,l.innerHTML=this.innerHTML,!(l.clientWidth<310))return;{const e=l.textContent.slice(0,15)+"...";l.innerHTML=e}for(t=this.parentNode.getElementsByClassName("same-as-selected"),n=0;n<t.length;n++)t[n].removeAttribute("class");this.setAttribute("class","same-as-selected");break}l.click()}),b.appendChild(c);x[i].appendChild(b),a.addEventListener("click",function(e){e.stopPropagation(),closeAllSelect(this),this.nextSibling.classList.toggle("select-hide"),this.classList.toggle("select-arrow-active")})}function closeAllSelect(e){var t,a,n,s=[];for(t=document.getElementsByClassName("select-items"),a=document.getElementsByClassName("select-selected"),n=0;n<a.length;n++)e==a[n]?s.push(n):a[n].classList.remove("select-arrow-active");for(n=0;n<t.length;n++)s.indexOf(n)&&t[n].classList.add("select-hide")}document.addEventListener("click",closeAllSelect);var fd=new FormData,data={id_city:"0"};$(document).on("click",".custom-select-js-cite > .select-items > div",function(){data.id_city=$(this).attr("data-id-cite"),fd.append("town",$(this).attr("data-id-cite")),$.ajax({url:"/ajax/form_city.php",type:"POST",data:data,dataType:"html",beforeSend:function(){$(".item_select").each(function(){$(this).remove(),$(".select-selected").last().html("Выберите регион:"),fd.delete("id_company")})}}).done(function(e){JSON.parse(e).forEach(function(e){$(".select-items").append('<div class="item_select" data-id-company="'+e.ID+'" >'+e.NAME+"</div>")}),$(".custom-select-js").removeClass("no_click")})}),$(document).on("click",".select-city",function(){let e=$(this).text();$(".select-arrow-active").text(e),fd.append("town",$(this).attr("data-id-cite"))}),$(document).on("click",".item_select",function(){let e=$(this).text();$(".select-arrow-active").text(e),fd.append("id_company",$(this).attr("data-id-company"))}),$(document).ready(function(){$("#change-data").click(function(){0==$(this).hasClass("click")?($(this).addClass("click"),$("#true_data_person").css({display:"none"}),$("#for_change_person").css({display:"block"}),$("#change-data").text("Отменить редактирование")):($(this).removeClass("click"),$("#true_data_person").css({display:"block"}),$("#for_change_person").css({display:"none"}),$("#change-data").text("Редактировать данные"))}),$("[name=personal_phone]").mask("+7(000)000-00-00")}),$("#save_data").click(function(e){e.preventDefault();var t=[],a=$("#form_change_data").serializeArray(),n=$(".input_file");if(null!=n.prop("files")[0]){n.prop("files")[0].size>10485760&&(t.push("error"),$(".block-error-label_size").css({display:"block"}),t.push("error"));var s=n.prop("files")[0].type;-1==(s=s.split("/")[1]).search("jpeg")&&-1==s.search("pjpeg")&&-1==s.search("png")&&($(".block-error-label_format").css({display:"block"}),t.push("error"))}a[5].value.length>16?($("[name=uf_insurance_policy]").after(' <span class="label danger  error-policy-max "  >Введен длинный номер полиса</span>'),t.push("error")):a[5].value.length<16&&($("[name=uf_insurance_policy]").after('<span class="label danger  error-policy-min "  >Введен короткий номер полиса</span>'),t.push("error")),console.log(a[3].value.length),a[3].value.length<16&&($("[name=personal_phone]").after('<span class="label danger  error-personal_phone "  >Введен короткий номер телефона</span>'),t.push("error")),a[0].value.length<2&&($("[name=name]").after('<span class="label danger  error-name "  >Введите имя</span>'),t.push("error")),a[1].value.length<2&&($("[name=last_name]").after('<span class="label danger  error-last_name "  >Введите фамилию</span>'),t.push("error")),a[2].value.length<2&&($("[name=second_name]").after('<span class="label danger  error-second_name "  >Введите отчество</span>'),t.push("error")),a[4].value.length<2&&($("[name=email]").after('<span class="label danger  error-email "  >Введите эмеил</span>'),t.push("error")),fd.append("import_file",n.prop("files")[0]),fd.append("name",a[0].value),fd.append("last_name",a[1].value),fd.append("second_name",a[2].value),fd.append("personal_phone",a[3].value),fd.append("email",a[4].value),fd.append("uf_insurance_policy",a[5].value),0==t.length&&$.ajax({url:"/ajax/change_data_user.php",type:"POST",data:fd,processData:!1,contentType:!1,beforeSend:function(){},success:function(e){"1"==e&&window.location.reload(),"Пользователь с таким эмейлом уже есть"==e&&$(".input_email").after('<p class="danger">Пользователь с таким эмейлом уже есть</p>')}}).done(function(e){})}),$(document).ready(function(){for(var e=document.querySelectorAll(".file-input"),t=0,a=e.length;t<a;t++)n(e[t]);function n(e){const t=e.querySelector('[type="file"]'),a=e.querySelector("[data-js-label]");t.onchange=t.onmouseout=function(){if(t.value){var n=t.value.replace(/^.*[\\\/]/,"");e.className+=" -chosen",a.innerText=n}}}});