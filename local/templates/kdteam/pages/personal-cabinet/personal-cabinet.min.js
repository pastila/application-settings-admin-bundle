var fd=new FormData,data={id_city:"0"};function cancel(e){$(document).on("click","#cancel_edit_"+e,function(){location.reload()})}function save(e){$(document).on("click","#save_edit_"+e,function(r){let t=$("#hospital_input_"+e).attr("data-id_hospital");$form=document.getElementById("edit_children_form_"+e),$form.checkValidity()&&$.post("/ajax/add_children.php",{name:$("#children_name_add_"+e).val(),surname:$("#children_last_name_add_"+e).val(),patronymic:$("#children_second_name_add_"+e).val(),policy:$("#child_policy_add_"+e).val(),hospital:t,birthday:$("#children_birthday_add_"+e).val(),id:e},function(r){"error"===r?$(".error_search-js_"+e).css("display","block"):"success"===r&&$.post("/ajax/cur_children.php",function(e){location.reload()})},"html")})}function search_region(){$(document).on("click","#search_result_region li",function(){$("#region_input").val($(this).text()),$("#search_result_region").fadeOut()}),$(document).on("click","#region_input",function(){$("#search_result_region").css("display","block")}),$(document).mouseup(function(e){0===$("#region_input").has(e.target).length&&$("#search_result_region").fadeOut()}),$(document).on("click",".region-js",function(){let e=$(this).attr("value"),r=$("#hospitals");$.post("/ajax/choice_hospital.php",{id:e},function(e){$(r).html(e),search_hospital()},"html")})}function search_region_edit(e){$(document).on("click","#search_result_region"+e+" li",function(){$("#region_input_"+e).val($(this).text()),$("#search_result_region_"+e).fadeOut()}),$(document).on("click","#region_input_"+e,function(){$("#search_result_region_"+e).css("display","block")}),$(document).mouseup(function(r){0===$("#region_input_"+e).has(r.target).length&&$("#search_result_region_"+e).fadeOut()}),$(document).on("click",".region-js_"+e,function(){let r=$(this).attr("value"),t=$("#hospitals_"+e);$.post("/ajax/choice_hospital_edit.php",{id:r,el:e},function(r){$(t).html(r),search_hospital_edit(e)},"html")})}function search_hospital_edit(e){$(document).on("click","#search_result_hospital_"+e+" li",function(){$("#hospital_input_"+e).val($(this).text()),$("#hospital_input_"+e).attr("data-id_hospital",$(this).attr("value")),$("#search_result_hospital_"+e).fadeOut()}),$(document).on("click","#hospital_input_"+e,function(){$("#search_result_hospital_"+e).css("display","block")}),$(document).mouseup(function(r){0===$("#hospital_input_"+e).has(r.target).length&&$("#search_result_hospital_"+e).fadeOut()}),keyup_region_edit(e),keyup_hospital_edit($("#region_input_"+e).attr("data-id_region"),e)}function search_hospital(){$(document).on("click","#search_result_hospital_down li",function(){$("#hospital_input").val($(this).text()),$("#hospital_input").attr("data-id_hospital",$(this).attr("value")),$("#search_result_hospital_down").fadeOut()}),$(document).on("click","#hospital_input",function(){$("#search_result_hospital_down").css("display","block")}),$(document).mouseup(function(e){0===$("#hospital_input").has(e.target).length&&$("#search_result_hospital_down").fadeOut()}),keyup_region(),keyup_hospital($("#region_input").attr("data-id_region"))}function keyup_region_edit(e){$("#region_input_"+e).on("keyup",function(){var r=$(this);clearTimeout(r.data("timer")),r.data("timer",setTimeout(function(){r.removeData("timer"),$("#search_result_region_"+e).css("display","block"),$.post("/ajax/smart_search_region_edit.php",{name_city:r.val(),el:e},function(r){0!=$(".error_region_"+e).length&&$(".error_region_"+e).remove(),$(".region-js_"+e).each(function(){$(this).remove()}),"error_region"==r?0!=$(".error_region_"+e).length?($(".error_region_"+e).remove(),$("#search_result_region_"+e).append('<li class="error_region_'+e+'">Регион не найден</li>')):$("#search_result_region_"+e).append('<li class="error_region_'+e+'">Регион не найден</li>'):(setTimeout(function(){$("#search_result_region_"+e).append(r)},100),$(document).on("click",".region-js_"+e,function(){let r=$(this).attr("value"),t=$(this).text();$("#region_input_"+e).val(t),$("#region_input_"+e).attr("data-id_region",e);let a=$("#hospitals_"+e);$.ajax({dataType:"html",url:"/ajax/choice_hospital_edit.php",type:"POST",data:{id:r,el:e},beforeSend:function(){},success:function(r){$(a).html(r),search_hospital_edit(e),keyup_hospital_edit($("#region_input_"+e).attr("data-id_region"),e)}}).done(function(e){})}))})},500))})}function keyup_region(){$("#region_input").on("keyup",function(){var e=$(this);clearTimeout(e.data("timer")),e.data("timer",setTimeout(function(){e.removeData("timer"),$("#search_result_region").css("display","block"),$.post("/ajax/smart_search_region.php",{name_city:e.val()},function(e){0!=$(".error_region").length&&$(".error_region").remove(),$(".region-js").each(function(){$(this).remove()}),"error_region"==e?0!=$(".error_region").length?($(".error_region").remove(),$("#search_result_region").append('<li class="error_region">Регион не найден</li>')):$("#search_result_region").append('<li class="error_region">Регион не найден</li>'):(setTimeout(function(){$("#search_result_region").append(e)},100),$(document).on("click",".region-js",function(){let e=$(this).attr("value"),r=$(this).text();$("#region_input").val(r),$("#region_input").attr("data-id_region",e);let t=$("#hospitals");$.ajax({dataType:"html",url:"/ajax/choice_hospital.php",type:"POST",data:{id:e},beforeSend:function(){},success:function(e){$(t).html(e),search_hospital(),keyup_hospital($("#region_input").attr("data-id_region"))}}).done(function(e){})}))})},500))})}function keyup_hospital(e){$("#hospital_input").on("keyup",function(){var r=$(this);clearTimeout(r.data("timer")),r.data("timer",setTimeout(function(){r.removeData("timer"),$("#search_result_hospital_down").css("display","block"),$.post("/ajax/smart_search_hosp.php",{name_hospital:r.val(),region_id:e},function(e){0!=$(".error_hospital").length&&$(".error_hospital").remove(),$(".hospital-js").each(function(){$(this).remove()}),"error_hospital"==e?0!=$(".error_hospital").length?($(".error_hospital").remove(),$("#search_result_hospital_down").append('<li class="error_region error_hospital">Компания не найдена</li>')):$("#search_result_hospital_down").append('<li class="error_region error_hospital">Компания не найдена</li>'):(setTimeout(function(){$("#search_result_hospital_down").append(e)},100),$(document).on("click",".hospital-js",function(){let e=$(this).attr("value"),r=$(this).text();$("#hospital_input").val(r),$("#hospital_input").attr("data-id_hospital",e)}))})},500))})}function keyup_hospital_edit(e,r){$("#hospital_input_"+r).on("keyup",function(){var t=$(this);clearTimeout(t.data("timer")),t.data("timer",setTimeout(function(){t.removeData("timer"),$("#search_result_hospital_"+r).css("display","block"),$.post("/ajax/smart_search_hosp_edit.php",{name_hospital:t.val(),region_id:e,el:r},function(e){0!=$(".error_hospital_"+r).length&&$(".error_hospital_"+r).remove(),$(".hospital-js_"+r).each(function(){$(this).remove()}),"error_hospital"==e?0!=$(".error_hospital_"+r).length?($(".error_hospital_"+r).remove(),$("#search_result_hospital_"+r).append('<li class="error_region error_hospital_'+r+'">Компания не найдена</li>')):$("#search_result_hospital_"+r).append('<li class="error_region error_hospital_'+r+'">Компания не найдена</li>'):(setTimeout(function(){$("#search_result_hospital_"+r).append(e)},100),$(document).on("click",".hospital-js_"+r,function(){let e=$(this).attr("value"),r=$(this).text();$("#hospital_input_"+e).val(r),$("#hospital_input_"+e).attr("data-id_hospital",e)}))})},500))})}$(document).ready(function(){$("#children_last_name_add, #children_name_add, #children_second_name_add, #famaly-name, #name, #last-name, [id*=children_second_name_add], [id*=children_name_add],[id*=children_last_name_add]").bind("change keyup input click",function(){this.value.match(/[^а-яёА-ЯЁ\-]/g)&&(this.value=this.value.replace(/[^а-яёА-ЯЁ\-]/g,""))}),$("#famaly-name, [id*=children_last_name_add]").on("keyup",function(){var e=$(this);clearTimeout(e.data("timer")),e.data("timer",setTimeout(function(){if(e.removeData("timer"),e.val().length>0)if(!1===obj_correction_name.is_harder_str(e)){var r=obj_correction_name.correction_plain_str(e);e.val(r)}else{r=obj_correction_name.correction_harder_str(e);e.val(r)}},2200))}),$("#name, [id*=children_name_add]").on("keyup",function(){var e=$(this);clearTimeout(e.data("timer")),e.data("timer",setTimeout(function(){if(e.removeData("timer"),e.val().length>0)if(!1===obj_correction_name.is_harder_str(e)){var r=obj_correction_name.correction_plain_str(e);e.val(r)}else{r=obj_correction_name.correction_harder_str(e);e.val(r)}},2200))}),$("#last-name, [id*=children_second_name_add]").on("keyup",function(){var e=$(this);clearTimeout(e.data("timer")),e.data("timer",setTimeout(function(){if(e.removeData("timer"),e.val().length>0)if(!1===obj_correction_name.is_harder_str(e)){var r=obj_correction_name.correction_plain_str(e);e.val(r)}else{r=obj_correction_name.correction_harder_str(e);e.val(r)}},2200))}),$(document).on("click","#search_result li",function(){$("#referal").val($(this).text()),$("#search_result").fadeOut()}),$(document).on("click","#referal",function(){$("#search_result").css({display:"block"})}),$(document).mouseup(function(e){0===$("#referal").has(e.target).length&&$("#search_result").fadeOut()}),$(document).on("click","#search_result_hospital li",function(){$("#referal_two").val($(this).text()),$("#search_result_hospital").fadeOut()}),$(document).on("click","#referal_two",function(){$("#search_result_hospital").css({display:"block"})}),$(document).mouseup(function(e){0===$("#referal_two").has(e.target).length&&$("#search_result_hospital").fadeOut()}),$("#referal").on("keyup",function(){var e=$(this);""==e.val()&&(e.attr("data-id_region",""),$(".hospital").each(function(){$(this).remove()}),$("#hospital").remove(),$("#referal_two").val(""),$("#referal_two").attr("data-id_region","")),$("#search_result").css({display:"block"}),clearTimeout(e.data("timer")),e.data("timer",setTimeout(function(){e.removeData("timer"),$.post("/ajax/personal-cabinet/search_region.php",{name_city:e.val()},function(e){0!=$(".error_region").length&&$(".error_region").remove(),$(".region").each(function(){$(this).remove()}),"error_region"==e?0!=$(".error_region").length?($(".error_region").remove(),$("#search_result").append('<li class="error_region" >Регион не найден</li>')):$("#search_result").append('<li class="error_region" >Регион не найден</li>'):setTimeout(function(){$("#search_result").append(e)},100)})},500))}),$(document).on("click",".region",function(){$(".search-second").css({"pointer-events":"inherit"});let e=$(this).attr("value");$("#referal").attr("data-id_region",e),$("#referal").attr("data-region_check","check"),$("#referal_two").val(""),$.post("/ajax/personal-cabinet/search_company.php",{region_id:$("#referal").attr("data-id_region")},function(e){0!=$(".error_region").length&&$(".error_region").remove(),$(".hospital").each(function(){$(this).remove()}),$(".hospital-empty").remove(),setTimeout(function(){$("#search_result_hospital").append(e)},100)})}),$(document).on("click",".hospital",function(){let e=$(this).attr("value"),r=$(this).text();$("#referal_two").val(r),$("#referal_two").attr("data-id_region",e),$("#referal_two").attr("data-region_check","check")}),$("#referal_two").on("keyup",function(){var e=$(this);""==e.val()&&e.attr("data-id_region",""),$("#search_result_hospital").css({display:"block"}),clearTimeout(e.data("timer")),e.data("timer",setTimeout(function(){e.removeData("timer"),$.post("/ajax/personal-cabinet/search_company.php",{name_hospital:e.val(),region_id:$("#referal").attr("data-id_region")},function(e){0!=$(".error_region").length&&$(".error_region").remove(),$(".hospital").each(function(){$(this).remove()}),$(".hospital-empty").remove(),"error_company"==e?0!=$(".error_region").length?($(".error_region").remove(),$("#search_result_hospital").append('<li class="error_region" >Компания не найдена</li>'),$(".hospital-empty").remove()):($("#search_result_hospital").append('<li class="error_region" >Компания не найдена</li>'),$(".hospital-empty").remove()):setTimeout(function(){$("#search_result_hospital").append(e)},100)})},500))}),$("#change-data").click(function(){0==$(this).hasClass("click")?($(this).addClass("click"),$("#true_data_person").css({display:"none"}),$("#for_change_person").css({display:"block"}),$("#change-data").text("Отменить редактирование")):($(this).removeClass("click"),$("#true_data_person").css({display:"block"}),$("#for_change_person").css({display:"none"}),$("#change-data").text("Редактировать данные"))}),$("[name=personal_phone]").mask("+7(000)000-00-00"),$("#save_data").click(function(e){e.preventDefault();var r=[],t=$("#form_change_data").serializeArray();$(".input_file");t[4].value.length>16?($("[name=uf_insurance_policy]").after('   <div class="popover_error">\n          <div class="popover_error_arrow"></div>\n          <div class="popover_error_image">\n          <img src="/local/templates/kdteam/images/svg/error.svg" alt="Ошибка">\n          </div>\n          <div class="popover_error_text">\n        Введен длинный номер полиса.\n      </div>\n      </div>'),r.push("error")):t[4].value.length<16&&($("[name=uf_insurance_policy]").after('   <div class="popover_error">\n          <div class="popover_error_arrow"></div>\n          <div class="popover_error_image">\n          <img src="/local/templates/kdteam/images/svg/error.svg" alt="Ошибка">\n          </div>\n          <div class="popover_error_text">\n        Введен короткий номер полиса.\n      </div>\n      </div>'),r.push("error"));let a=$("#referal").attr("data-id_region");if(""!=a||null!=a||"0"!=a){fd.append("town",a);let e=$("#referal_two").attr("data-id_region");""==e&&null==e&&"0"==a||fd.append("id_company",e)}t[1].value.length<2&&($("[name=name]").after('   <div class="popover_error">\n          <div class="popover_error_arrow"></div>\n          <div class="popover_error_image">\n          <img src="/local/templates/kdteam/images/svg/error.svg" alt="Ошибка">\n          </div>\n          <div class="popover_error_text">\n        Введите имя.\n      </div>\n      </div>'),r.push("error")),t[0].value.length<2&&($("[name=last_name]").after('   <div class="popover_error">\n          <div class="popover_error_arrow"></div>\n          <div class="popover_error_image">\n          <img src="/local/templates/kdteam/images/svg/error.svg" alt="Ошибка">\n          </div>\n          <div class="popover_error_text">\n        Введите фамилию.\n      </div>\n      </div>'),r.push("error")),t[2].value.length<2&&($("[name=second_name]").after('   <div class="popover_error">\n          <div class="popover_error_arrow"></div>\n          <div class="popover_error_image">\n          <img src="/local/templates/kdteam/images/svg/error.svg" alt="Ошибка">\n          </div>\n          <div class="popover_error_text">\n        Введите отчество.\n      </div>\n      </div>'),r.push("error")),t[3].value.length<2&&($("[name=email]").after('   <div class="popover_error">\n          <div class="popover_error_arrow"></div>\n          <div class="popover_error_image">\n          <img src="/local/templates/kdteam/images/svg/error.svg" alt="Ошибка">\n          </div>\n          <div class="popover_error_text">\n        Введите эмеил.\n      </div>\n      </div>'),r.push("error")),fd.append("name",t[1].value),fd.append("last_name",t[0].value),fd.append("second_name",t[2].value),fd.append("email",t[3].value),fd.append("uf_insurance_policy",t[4].value),0==r.length&&$.ajax({url:"/ajax/personal-cabinet/change_data_user.php",type:"POST",data:fd,processData:!1,contentType:!1,beforeSend:function(){},success:function(e){var r=JSON.parse(e);""!=r.user_email_already&&void 0!==r.user_email_already&&$(".input_email").after('   <div class="popover_error">\n          <div class="popover_error_arrow"></div>\n          <div class="popover_error_image">\n          <img src="/local/templates/kdteam/images/svg/error.svg" alt="Ошибка">\n          </div>\n          <div class="popover_error_text">\n        Пользователь с таким эмейлом уже есть.\n      </div>\n      </div>'),""!=r.user_policy_already&&void 0!==r.user_policy_already&&$(".numberInput").after('   <div class="popover_error">\n          <div class="popover_error_arrow"></div>\n          <div class="popover_error_image">\n          <img src="/local/templates/kdteam/images/svg/error.svg" alt="Ошибка">\n          </div>\n          <div class="popover_error_text">\n        Пользователь с таким полисом уже есть.\n      </div>\n      </div>'),""!==r.true&&void 0!==r.true&&window.location.reload()}}).done(function(e){})});for(var e=document.querySelectorAll(".file-input"),r=0,t=e.length;r<t;r++)a(e[r]);function a(e){const r=e.querySelector('[type="file"]'),t=e.querySelector("[data-js-label]");r.onchange=r.onmouseout=function(){if(r.value){var a=r.value.replace(/^.*[\\\/]/,"");e.className+=" -chosen",t.innerText=a}}}$(document).on("click","#add_children_btn",function(){search_region(),keyup_region(),$("#add_children").css("display","block"),$("#add_children_btn").css("display","none")}),$(document).on("click","#cancel",function(){$("#add_children").css("display","none"),$("#add_children_btn").css("display","inline-flex"),$("#add_children_form")[0].reset()}),$(document).on("click","#save_children",function(e){let r=$("#hospital_input").attr("data-id_hospital");$form=document.getElementById("add_children_form"),$form.checkValidity()&&$.post("/ajax/add_children.php",{name:$("#children_name_add").val(),surname:$("#children_last_name_add").val(),patronymic:$("#children_second_name_add").val(),town:$(".id_region").val(),policy:$("#child_policy_add").val(),hospital:r,birthday:$("#children_birthday_add").val()},function(e){"error"===e?$(".error_search-js").css("display","block"):"success"===e&&($("#add_children").css("display","none"),$("#add_children_btn").css("display","flex"),$("#add_children_form")[0].reset(),$.post("/ajax/cur_children.php",function(e){$("#cur_children").html(e)}))},"html")}),$(document).on("click",".del_js",function(){let e=$(this).attr("id").split("_"),r=$("#element_"+e[1]);$.ajax({url:"/ajax/del_child.php",data:{ID:e[1]},type:"post",success:function(){r.remove()}})}),$(document).on("click",".edit_js",function(){let e=$(this).attr("id").split("_");$("#element_"+e[1]);$("#edit_children_"+e[1]).css("display","block"),$("#element_"+e[1]).css("display","none"),search_region_edit(e[1]),keyup_region_edit(e[1]),search_hospital_edit(e[1]),cancel(e[1]),save(e[1]),keyup_hospital_edit($("#region_input_"+e[1]).attr("data-id_region"),e[1])})});