var x,i,j,selElmnt,a,b,c;for(x=document.getElementsByClassName("custom-select"),i=0;i<x.length;i++){for(selElmnt=x[i].getElementsByTagName("select")[0],(a=document.createElement("DIV")).setAttribute("class","select-selected"),a.innerHTML=selElmnt.options[selElmnt.selectedIndex].innerHTML,x[i].appendChild(a),(b=document.createElement("DIV")).setAttribute("class","select-items select-hide"),j=1;j<selElmnt.length;j++)(c=document.createElement("DIV")).innerHTML=selElmnt.options[j].innerHTML,c.setAttribute("data-id-cite",selElmnt.options[j].value),c.setAttribute("class","select-city"),c.addEventListener("click",function(e){var t,a,r,i,n;for(i=this.parentNode.parentNode.getElementsByTagName("select")[0],n=this.parentNode.previousSibling,a=0;a<i.length;a++)if(i.options[a].innerHTML==this.innerHTML){if(i.selectedIndex=a,n.innerHTML=this.innerHTML,!(n.clientWidth<310))return;{const e=n.textContent.slice(0,15)+"...";n.innerHTML=e}for(t=this.parentNode.getElementsByClassName("same-as-selected"),r=0;r<t.length;r++)t[r].removeAttribute("class");this.setAttribute("class","same-as-selected");break}n.click()}),b.appendChild(c);x[i].appendChild(b),a.addEventListener("click",function(e){e.stopPropagation(),closeAllSelect(this),this.nextSibling.classList.toggle("select-hide"),this.classList.toggle("select-arrow-active")})}function closeAllSelect(e){var t,a,r,i=[];for(t=document.getElementsByClassName("select-items"),a=document.getElementsByClassName("select-selected"),r=0;r<a.length;r++)e==a[r]?i.push(r):a[r].classList.remove("select-arrow-active");for(r=0;r<t.length;r++)i.indexOf(r)&&t[r].classList.add("select-hide")}document.addEventListener("click",closeAllSelect);var data={id_city:"0",id_compani:"0",head:"0",text:"0",star:"0",letter:"0"};$(".star").click(function(){data.star=$(this).attr("data-value")}),$(document).ready(function(){$(document).on("click","#search_result li",function(){$("#referal").val($(this).text()),$("#search_result").fadeOut()}),$(document).on("click","#referal",function(){$("#search_result").css({display:"block"})}),$(document).mouseup(function(e){0===$("#referal").has(e.target).length&&$("#search_result").fadeOut()}),$(document).on("click","#search_result_hospital li",function(){$("#referal_two").val($(this).text()),$("#search_result_hospital").fadeOut()}),$(document).on("click","#referal_two",function(){$("#search_result_hospital").css({display:"block"})}),$(document).mouseup(function(e){0===$("#referal_two").has(e.target).length&&$("#search_result_hospital").fadeOut()}),$("#referal").on("keyup",function(){var e=$(this);""==e.val()&&(e.attr("data-id_region",""),$(".hospital").each(function(){$(this).remove()}),$("#hospital").remove(),$("#referal_two").val(""),$("#referal_two").attr("data-id_region","")),clearTimeout(e.data("timer")),e.data("timer",setTimeout(function(){e.removeData("timer"),$.post("/ajax/smart_search.php",{name_city:e.val()},function(e){0!=$(".error_region").length&&$(".error_region").remove(),$(".region").each(function(){$(this).remove()}),"error_region"==e?0!=$(".error_region").length?($(".error_region").remove(),$("#search_result").append('<li class="error_region" >Регион не найден</li>')):$("#search_result").append('<li class="error_region" >Регион не найден</li>'):setTimeout(function(){$("#search_result").append(e)},100)})},500))}),$(document).on("click",".region",function(){let e=$(this).attr("value");$("#referal").attr("data-id_region",e),$("#referal").attr("data-region_check","check"),$.post("/ajax/smart_search_hospital.php",{region_id:$("#referal").attr("data-id_region")},function(e){0!=$(".error_region").length&&$(".error_region").remove(),$(".hospital").each(function(){$(this).remove()}),$(".hospital-empty").remove(),setTimeout(function(){$("#search_result_hospital").append(e)},100)})}),$(document).on("click",".hospital",function(){let e=$(this).attr("value"),t=$(this).text();$("#referal_two").val(t),$("#referal_two").attr("data-id_region",e),$("#referal_two").attr("data-region_check","check")}),$("#referal_two").on("keyup",function(){var e=$(this);""==e.val()&&e.attr("data-id_region",""),clearTimeout(e.data("timer")),e.data("timer",setTimeout(function(){e.removeData("timer"),$.post("/ajax/smart_search_hospital.php",{name_hospital:e.val(),region_id:$("#referal").attr("data-id_region")},function(e){0!=$(".error_region").length&&$(".error_region").remove(),$(".hospital").each(function(){$(this).remove()}),$(".hospital-empty").remove(),"error_hospital"==e?(keyup_class(),0!=$(".error_region").length?($(".error_region").remove(),$("#search_result_hospital").append('<li class="error_region" >Больница не найдена</li>'),$(".hospital-empty").remove()):($("#search_result_hospital").append('<li class="error_region" >Больница не найдена</li>'),$(".hospital-empty").remove())):setTimeout(function(){$("#search_result_hospital").append(e)},100)})},500))}),$(document).on("click",".hospital",function(){let e=$(this).attr("value"),t=$(this).text();$("#referal_two").val(t),$("#referal_two").attr("data-id_region",e),$("#referal_two").attr("data-region_check","check")}),$("#form-comments").validator().on("submit",function(e){e.preventDefault();var t=$("#form-comments").serializeArray();let a=[],r=$("#referal").attr("data-id_region");""==r||null==r?($("#referal").after('<span class="label danger"  >Выберете регион</span>'),a.push("error")):data.id_city=r;let i=$("#referal_two").attr("data-id_region");""==i||null==i?($("#referal_two").after('<span class="label danger"  >Выберете больницу</span>'),a.push("error")):data.id_compani=i,data.head=t[0].value,data.text=t[1].value,0==data.id_city&&($("[data-select=city]").next().css({display:"block"}),a.push("city")),0==data.id_compani&&($("[data-select=company]").next().css({display:"block"}),a.push("company")),null!=function(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}("letter")&&(data.letter="1"),console.log(data),0==a.length&&$.ajax({url:"/ajax/add_reviews.php",type:"POST",data:data,dataType:"html",beforeSend:function(){}}).done(function(e){1==e&&$.magnificPopup.open({items:{src:'<div class="white-popup custom_styles_popup" >Ваш отзыв успешно отправлен</div>',type:"inline"},callbacks:{afterClose:function(){document.location.reload(!0)}}})})})});