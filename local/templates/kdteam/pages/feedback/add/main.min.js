var x,i,j,selElmnt,a,b,c;for(x=document.getElementsByClassName("custom-select"),i=0;i<x.length;i++){for(selElmnt=x[i].getElementsByTagName("select")[0],(a=document.createElement("DIV")).setAttribute("class","select-selected"),a.innerHTML=selElmnt.options[selElmnt.selectedIndex].innerHTML,x[i].appendChild(a),(b=document.createElement("DIV")).setAttribute("class","select-items select-hide"),j=1;j<selElmnt.length;j++)(c=document.createElement("DIV")).innerHTML=selElmnt.options[j].innerHTML,c.setAttribute("data-id-cite",selElmnt.options[j].value),c.setAttribute("class","select-city"),c.addEventListener("click",function(e){var t,a,s,n,c;for(n=this.parentNode.parentNode.getElementsByTagName("select")[0],c=this.parentNode.previousSibling,a=0;a<n.length;a++)if(n.options[a].innerHTML==this.innerHTML){if(n.selectedIndex=a,c.innerHTML=this.innerHTML,!(c.clientWidth<310))return;{const e=c.textContent.slice(0,15)+"...";c.innerHTML=e}for(t=this.parentNode.getElementsByClassName("same-as-selected"),s=0;s<t.length;s++)t[s].removeAttribute("class");this.setAttribute("class","same-as-selected");break}c.click()}),b.appendChild(c);x[i].appendChild(b),a.addEventListener("click",function(e){e.stopPropagation(),closeAllSelect(this),this.nextSibling.classList.toggle("select-hide"),this.classList.toggle("select-arrow-active")})}function closeAllSelect(e){var t,a,s,n=[];for(t=document.getElementsByClassName("select-items"),a=document.getElementsByClassName("select-selected"),s=0;s<a.length;s++)e==a[s]?n.push(s):a[s].classList.remove("select-arrow-active");for(s=0;s<t.length;s++)n.indexOf(s)&&t[s].classList.add("select-hide")}document.addEventListener("click",closeAllSelect);var data={id_city:"0",id_compani:"0",head:"0",text:"0",star:"0",letter:"0"};$(".star").click(function(){data.star=$(this).attr("data-value")}),$(document).on("click",".custom-select-js-cite > .select-items > div",function(){data.id_city=$(this).attr("data-id-cite"),$.ajax({url:"/ajax/form_city.php",type:"POST",data:data,dataType:"html",beforeSend:function(){$(".item_select").each(function(){$(this).remove()})}}).done(function(e){JSON.parse(e).forEach(function(e){$(".select-items").append('<div class="item_select" data-id-company="'+e.ID+'" >'+e.NAME+"</div>")}),$(".custom-select-js").removeClass("no_click")})}),$(document).on("click",".item_select",function(){let e=$(this).text();$(".select-arrow-active").text(e),data.id_compani=$(this).attr("data-id-company")}),$(document).ready(function(){$("#form-comments").validator().on("submit",function(e){e.preventDefault();var t=$("#form-comments").serializeArray();let a=[];data.head=t[0].value,data.text=t[1].value,0==data.id_city&&($("[data-select=city]").next().css({display:"block"}),a.push("city")),0==data.id_compani&&($("[data-select=company]").next().css({display:"block"}),a.push("company")),null!=function(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}("letter")&&(data.letter="1"),console.log(data),0==a.length&&$.ajax({url:"/ajax/add_reviews.php",type:"POST",data:data,dataType:"html",beforeSend:function(){}}).done(function(e){1==e&&$.magnificPopup.open({items:{src:'<div class="white-popup custom_styles_popup" >Ваш отзыв успешно отправлен</div>',type:"inline"},callbacks:{afterClose:function(){document.location.reload(!0)}}})})})});